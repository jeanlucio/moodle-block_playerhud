define("block_playerhud/filter_collect",["jquery","core/notification"],(function($,Notification){return{init:function(strings){$("body").on("click",".ph-action-collect",(function(e){e.preventDefault();var trigger=$(this);if(!trigger.hasClass("disabled")&&!trigger.attr("disabled")){var originalHtml=trigger.html(),originalWidth=trigger.outerWidth();trigger.css("width",originalWidth+"px"),trigger.html('<i class="fa fa-spinner fa-spin"></i>'),trigger.addClass("disabled").attr("aria-busy","true");var url=trigger.attr("href"),ajaxUrl=url+(-1===url.indexOf("?")?"?":"&")+"ajax=1";$.ajax({url:ajaxUrl,method:"GET",dataType:"json",success:function(resp){if(resp.success){if(trigger.removeClass("btn-primary ph-action-collect").removeAttr("href").removeAttr("aria-busy"),resp.cooldown_deadline&&resp.cooldown_deadline>0){var timerHtml='⏳ <span class="ph-timer" data-deadline="'+resp.cooldown_deadline+'">...</span>',timerBtn=$('<div class="btn btn-light btn-sm w-100 text-muted" tabindex="0" role="timer" aria-live="off">'+timerHtml+"</div>");trigger.replaceWith(timerBtn),timerBtn.focus()}else trigger.addClass("btn-success disabled").css("cursor","default").attr("aria-disabled","true").html('<i class="fa fa-check"></i> '+strings.collected),trigger.attr("tabindex","0"),trigger.focus();if(resp.game_data){var widget=$(".playerhud-widget-container");if(widget.length){var data=resp.game_data;widget.find(".progress-bar").css("width",data.progress+"%").attr("aria-valuenow",data.progress),widget.find(".badge").each((function(){var text=$(this).text();-1===text.indexOf("Level")&&-1===text.indexOf("Nível")||($(this).text("Level "+data.level),$(this).addClass("animate__animated animate__pulse"))})),widget.find("span.text-muted").each((function(){var el=$(this);-1!==el.text().indexOf("XP")&&(el.text(data.currentxp+" XP"),el.addClass("text-success fw-bold"),setTimeout((function(){el.removeClass("text-success fw-bold")}),2e3))}))}}}else restaurarBotao(),Notification.alert("Ops",resp.message,"OK")},error:function(){restaurarBotao(),Notification.alert("Erro",strings.error,"OK")}})}function restaurarBotao(){trigger.html(originalHtml),trigger.removeClass("disabled").removeAttr("aria-busy"),trigger.css("width","")}}))}}}));

//# sourceMappingURL=filter_collect.min.js.map