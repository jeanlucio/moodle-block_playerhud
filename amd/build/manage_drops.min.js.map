{"version":3,"file":"manage_drops.min.js","sources":["../src/manage_drops.js"],"sourcesContent":["/* global bootstrap */\ndefine(['jquery', 'core/notification'], function($, Notification) {\n\n    return {\n        init: function(config) {\n            $('#codeGenModal').appendTo('body');\n\n            var currentItem = config.item;\n            var langStrings = config.strings;\n            var currentDropCode = 0;\n\n            // Elementos DOM.\n            var inputCode = document.getElementById('finalCode');\n            var previewBox = document.getElementById('previewContainer');\n\n            // Inputs de Personaliza√ß√£o.\n            var groupTextLink = document.getElementById('textInputGroup');\n            var inputLinkText = document.getElementById('customText');\n\n            var groupCardOptions = document.getElementById('cardCustomOptions');\n            var inputBtnText = document.getElementById('customBtnText');\n            var inputBtnEmoji = document.getElementById('customBtnEmoji');\n\n            // --- Listeners ---\n            document.body.addEventListener('click', function(e) {\n                // Delete Button Logic.\n                var deleteBtn = e.target.closest('.js-delete-btn');\n                if (deleteBtn) {\n                    e.preventDefault();\n                    Notification.confirm(\n                        langStrings.confirm_title,\n                        deleteBtn.getAttribute('data-confirm-msg'),\n                        langStrings.yes,\n                        langStrings.cancel,\n                        function() {\n                            window.location.href = deleteBtn.getAttribute('href');\n                        }\n                    );\n                    return;\n                }\n\n                // Open Modal Logic.\n                var trigger = e.target.closest('.js-open-gen-modal');\n                if (trigger) {\n                    e.preventDefault();\n                    currentDropCode = trigger.getAttribute('data-dropcode');\n\n                    // Reset Inputs.\n                    var radioCard = document.getElementById('modeCard');\n                    if (radioCard) {\n                        radioCard.checked = true;\n                    }\n\n                    // Limpa valores para usar o placeholder/padr√£o.\n                    if (inputLinkText) {\n                        inputLinkText.value = '';\n                    }\n                    if (inputBtnText) {\n                        inputBtnText.value = '';\n                    }\n                    if (inputBtnEmoji) {\n                        inputBtnEmoji.value = '';\n                    }\n\n                    updateGenerator();\n\n                    var el = document.getElementById('codeGenModal');\n                    if (el) {\n                        if (typeof bootstrap !== 'undefined' && bootstrap.Modal) {\n                            bootstrap.Modal.getOrCreateInstance(el).show();\n                        } else {\n                            $(el).modal('show');\n                        }\n                    }\n                }\n\n                // Copy Button Logic.\n                if (e.target.closest('#copyFinalCode')) {\n                    if (inputCode) {\n                        inputCode.select();\n                        inputCode.setSelectionRange(0, 99999);\n                        document.execCommand('copy');\n                        var fb = document.getElementById('copyFeedback');\n                        if (fb) {\n                            fb.style.display = 'inline-block';\n                            setTimeout(function() {\n                                fb.style.display = 'none';\n                            }, 3000);\n                        }\n                    }\n                }\n            });\n\n            // Listeners de Input para atualiza√ß√£o em tempo real.\n            document.body.addEventListener('change', handleChange);\n            document.body.addEventListener('input', handleChange);\n\n            /**\n             * Handles input changes to update preview.\n             *\n             * @param {Event} e The event object.\n             */\n            function handleChange(e) {\n                if (e.target.classList.contains('js-mode-trigger') ||\n                    e.target.id === 'customText' ||\n                    e.target.id === 'customBtnText' ||\n                    e.target.id === 'customBtnEmoji') {\n                    updateGenerator();\n                }\n            }\n\n            /**\n             * Updates the generator preview and code.\n             */\n            // eslint-disable-next-line complexity\n            function updateGenerator() {\n                var modeRadio = document.querySelector('input[name=\"codeMode\"]:checked');\n                var mode = modeRadio ? modeRadio.value : 'card';\n\n                var param = isNaN(currentDropCode) ? 'code=' + currentDropCode : 'id=' + currentDropCode;\n                var code = '[PLAYERHUD_DROP ' + param + ']'; // Base code.\n                var previewHtml = '';\n\n                // Visibilidade dos grupos de input.\n                if (groupTextLink) {\n                    groupTextLink.style.display = (mode === 'text') ? 'block' : 'none';\n                }\n                if (groupCardOptions) {\n                    groupCardOptions.style.display = (mode === 'card') ? 'block' : 'none';\n                }\n\n                if (mode === 'text') {\n                    // --- MODO TEXTO ---\n                    var linkTxt = (inputLinkText && inputLinkText.value.trim()) ?\n                        inputLinkText.value.trim() : langStrings.defaultText;\n\n                    code = '[PLAYERHUD_DROP ' + param + ' mode=text text=\"' + linkTxt + '\"]';\n\n                    previewHtml = '<a href=\"#\" onclick=\"return false;\" ' +\n                        'class=\"text-primary fw-bold text-decoration-underline\">' +\n                        linkTxt + '</a>';\n\n                } else if (mode === 'image') {\n                    // --- MODO IMAGEM ---\n                    code = '[PLAYERHUD_DROP ' + param + ' mode=image]';\n\n                    var imgContent = currentItem.isImage ?\n                        '<img src=\"' + currentItem.url + '\" style=\"width:50px; height:50px; object-fit:contain;\" alt=\"\">' :\n                        '<span style=\"font-size:40px;\" aria-hidden=\"true\">' + currentItem.content + '</span>';\n\n                    previewHtml = '<div style=\"cursor:pointer; filter: drop-shadow(0 4px 2px rgba(0,0,0,0.1));\">' +\n                        imgContent + '</div>';\n\n                } else {\n                    // --- MODO CARD (Padr√£o) ---\n                    var userTxt = (inputBtnText && inputBtnText.value.trim()) ? inputBtnText.value.trim() : '';\n                    var userEmo = (inputBtnEmoji && inputBtnEmoji.value.trim()) ? inputBtnEmoji.value.trim() : '';\n\n                    var previewTxt = userTxt || langStrings.takeBtn;\n                    var previewEmo = userEmo || 'üñê';\n\n                    var extraAttrs = '';\n                    if (userTxt !== '') {\n                        extraAttrs += ' button_text=\"' + userTxt + '\"';\n                    }\n                    if (userEmo !== '') {\n                        extraAttrs += ' button_emoji=\"' + userEmo + '\"';\n                    }\n\n                    code = '[PLAYERHUD_DROP ' + param + extraAttrs + ']';\n\n                    var iconHtml = currentItem.isImage ?\n                        '<img src=\"' + currentItem.url + '\" alt=\"\">' :\n                        '<div style=\"font-size:2.5em; line-height:1;\">' + currentItem.content + '</div>';\n\n                    var btnContent = previewTxt;\n                    if (previewEmo) {\n                        btnContent = '<span aria-hidden=\"true\" class=\"me-1\">' + previewEmo + '</span> ' + previewTxt;\n                    }\n\n                    previewHtml =\n                    '<div class=\"ph-gen-preview-real-card\">' +\n                        '<span class=\"badge bg-info text-dark rounded-pill position-absolute\" ' +\n                        'style=\"top:5px; right:5px; font-size:0.7rem;\">' + langStrings.yours + '</span>' +\n                        '<div class=\"mb-2 d-flex align-items-center justify-content-center\" style=\"height:60px;\">' +\n                            iconHtml +\n                        '</div>' +\n                        '<strong class=\"d-block mb-2 text-truncate\" style=\"font-size:0.9rem;\">' + currentItem.name + '</strong>' +\n                        '<button class=\"btn btn-primary btn-sm w-100 shadow-sm\">' + btnContent + '</button>' +\n                    '</div>';\n                }\n\n                if (inputCode) {\n                    inputCode.value = code;\n                }\n                if (previewBox) {\n                    previewBox.innerHTML = previewHtml;\n                }\n            }\n        }\n    };\n});\n"],"names":["define","$","Notification","init","config","appendTo","currentItem","item","langStrings","strings","currentDropCode","inputCode","document","getElementById","previewBox","groupTextLink","inputLinkText","groupCardOptions","inputBtnText","inputBtnEmoji","handleChange","e","target","classList","contains","id","updateGenerator","modeRadio","querySelector","mode","value","param","isNaN","code","previewHtml","style","display","linkTxt","trim","defaultText","isImage","url","content","userTxt","userEmo","previewTxt","takeBtn","previewEmo","extraAttrs","iconHtml","btnContent","yours","name","innerHTML","body","addEventListener","deleteBtn","closest","preventDefault","confirm","confirm_title","getAttribute","yes","cancel","window","location","href","trigger","radioCard","checked","el","bootstrap","Modal","getOrCreateInstance","show","modal","select","setSelectionRange","execCommand","fb","setTimeout"],"mappings":"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"}