{"version":3,"file":"filter_collect.min.js","sources":["../src/filter_collect.js"],"sourcesContent":["/* global bootstrap */\ndefine(['jquery', 'core/notification'], function($, Notification) {\n\n    /**\n     * Helper to retrieve modal elements, prioritizing the Block's modal if present.\n     * This ensures strict visual standardization and centralized maintenance.\n     *\n     * @return {Object} An object containing jQuery references to modal elements.\n     */\n    var getModalElements = function() {\n        // 1. Tenta encontrar o Modal \"Original\" do Bloco (Prioridade).\n        // IDs definidos em: blocks/playerhud/templates/modal_item.mustache.\n        var root = $('#phItemModalView');\n        var suffix = 'View';\n\n        // 2. Se n√£o existir (ex: p√°gina sem blocos), usa o Modal do Filtro (Fallback).\n        // IDs definidos em: filter/playerhud/templates/modals.mustache.\n        if (!root.length) {\n            root = $('#phItemModalFilter');\n            suffix = 'F';\n        }\n\n        return {\n            root: root,\n            // Seletores din√¢micos: adiciona o sufixo 'View' ou 'F' conforme o modal encontrado.\n            title: $('#phModalTitle' + suffix),\n            name: $('#phModalName' + suffix),\n            desc: $('#phModalDesc' + suffix),\n            imgContainer: $('#phModalImageContainer' + suffix),\n            xp: $('#phModalXP' + suffix),\n            countBadge: $('#phModalCountBadge' + suffix),\n            date: $('#phModalDate' + suffix),\n            dateContainer: $('#phModalDateContainer' + suffix)\n        };\n    };\n\n    /**\n     * Restores the button state in case of error or completion.\n     *\n     * @param {Object} btn The jQuery button element.\n     * @param {String} html The original HTML content of the button.\n     * @param {String} mode The display mode ('card', 'text', 'image').\n     * @param {String} width The original width of the button (for card mode).\n     */\n    var restaurar = function(btn, html, mode, width) {\n        btn.html(html).removeClass('disabled');\n        if (mode === 'card') {\n            btn.css('width', width);\n        } else {\n            btn.css('opacity', '1').css('pointer-events', 'auto');\n        }\n    };\n\n    /**\n     * Handles the visual state for Card Mode.\n     *\n     * @param {Object} trigger The clicked jQuery element.\n     * @param {Object} card The parent card jQuery element.\n     * @param {Boolean} hasTimer Whether the item is in cooldown.\n     * @param {Boolean} isLimit Whether the collection limit is reached.\n     * @param {Object} resp The server response object.\n     * @param {Object} strings The language strings object.\n     * @param {String} originalHtml The original HTML of the trigger.\n     */\n    var handleCardMode = function(trigger, card, hasTimer, isLimit, resp, strings, originalHtml) {\n        if (hasTimer) {\n            trigger.removeClass('btn-primary ph-action-collect').removeAttr('href');\n            var tHtml = '‚è≥ <span class=\"ph-timer\" data-deadline=\"' +\n                resp.cooldown_deadline + '\">...</span>';\n            var tBtn = $('<div class=\"btn btn-light btn-sm w-100 ph-text-dimmed\" tabindex=\"0\">' +\n                tHtml + '</div>');\n            trigger.replaceWith(tBtn);\n            tBtn.focus();\n        } else if (isLimit) {\n            trigger.removeClass('btn-primary ph-action-collect')\n                .addClass('btn-light text-success disabled border-success')\n                .css('cursor', 'default').removeAttr('href')\n                .html('<i class=\"fa fa-check\" aria-hidden=\"true\"></i> ' + strings.collected);\n            card.find('.ph-item-details-trigger').focus();\n        } else {\n            trigger.removeClass('btn-primary disabled').addClass('btn-success')\n                .html('<i class=\"fa fa-check\" aria-hidden=\"true\"></i> ' + strings.collected).css('width', '');\n            setTimeout(function() {\n                trigger.removeClass('btn-success').addClass('btn-primary')\n                    .html(originalHtml);\n                trigger.focus();\n            }, 1500);\n        }\n    };\n\n    /**\n     * Handles the visual state for Text and Image modes.\n     *\n     * @param {Object} trigger The clicked jQuery element.\n     * @param {String} mode The display mode ('text' or 'image').\n     * @param {Boolean} hasTimer Whether the item is in cooldown.\n     * @param {Boolean} isLimit Whether the collection limit is reached.\n     * @param {Object} resp The server response object.\n     */\n    var handleTextImageMode = function(trigger, mode, hasTimer, isLimit, resp) {\n        if (hasTimer || isLimit) {\n            if (mode === 'text') {\n                trigger.removeAttr('href').removeClass('ph-action-collect');\n                trigger.addClass('ph-item-details-trigger');\n                trigger.css('opacity', '1').css('pointer-events', 'auto').css('cursor', 'pointer');\n\n                if (isLimit) {\n                    trigger.addClass('text-success fw-bold')\n                        .html('<i class=\"fa fa-check\" aria-hidden=\"true\"></i> ' + trigger.text());\n                } else {\n                    trigger.addClass('ph-text-dimmed')\n                        .html('<span aria-hidden=\"true\">‚è≥</span> ' + trigger.text() +\n                        ' <small class=\"ph-timer\" data-deadline=\"' +\n                        resp.cooldown_deadline + '\">...</small>');\n                }\n            } else {\n                var container = trigger.closest('.ph-drop-image-container');\n                var imgWrapper = container.find('> div').first();\n                trigger.remove();\n\n                // Transforma container em gatilho.\n                container.addClass('ph-item-details-trigger')\n                         .attr('tabindex', '0')\n                         .attr('role', 'button')\n                         .css('cursor', 'pointer');\n\n                if (isLimit) {\n                    imgWrapper.addClass('ph-state-grayscale');\n                    container.append('<span class=\"badge bg-success rounded-circle ph-badge-bottom-right\">' +\n                        '<i class=\"fa fa-check\" aria-hidden=\"true\"></i></span>');\n                } else {\n                    imgWrapper.addClass('ph-state-dimmed');\n                    container.append('<div class=\"ph-timer badge bg-light text-dark border shadow-sm ph-badge-bottom-center\" ' +\n                        'data-deadline=\"' + resp.cooldown_deadline + '\" data-no-label=\"1\">...</div>');\n                }\n            }\n        } else {\n            if (mode === 'text') {\n                trigger.css('opacity', '1').css('pointer-events', 'auto');\n                var oldColor = trigger.css('color');\n                trigger.css('color', '#198754');\n                setTimeout(function() {\n                    trigger.css('color', oldColor);\n                }, 1000);\n            } else {\n                trigger.css('opacity', '1').css('pointer-events', 'auto');\n            }\n        }\n    };\n\n    /**\n     * Updates the Stash (Recent Items) UI.\n     * Separated to reduce complexity.\n     *\n     * @param {Object} itemData Data of the collected item.\n     */\n    var updateStash = function(itemData) {\n        var stashes = $('.ph-sidebar-stash, .ph-widget-stash');\n\n        stashes.each(function() {\n            var stash = $(this);\n            var wrapper = stash.closest('.ph-stash-wrapper');\n\n            if (wrapper.length) {\n                wrapper.removeClass('d-none').show();\n            }\n\n            stash.find('.text-muted').remove();\n            stash.find('span.small').remove();\n\n            var contentHtml = '';\n            // CLEANUP: Estilo inline movido para classes se poss√≠vel, ou mantido apenas para object-fit essencial\n            if (String(itemData.isimage) === '1') {\n                contentHtml = '<img src=\"' + itemData.image + '\" alt=\"\" ' +\n                    'style=\"width: 100%; height: 100%; object-fit: contain;\">';\n            } else {\n                contentHtml = '<span class=\"ph-mini-emoji\" aria-hidden=\"true\" ' +\n                    'style=\"font-size:1.2rem; line-height: 1;\">' + itemData.image + '</span>';\n            }\n\n            // CLEANUP: Classes Bootstrap e do Plugin\n            var classes = 'ph-mini-item ph-item-trigger border bg-white rounded ' +\n                'd-flex align-items-center justify-content-center overflow-hidden position-relative shadow-sm';\n\n            var newItem = $('<div class=\"' + classes + '\" role=\"button\" tabindex=\"0\"></div>');\n\n            // CLEANUP CR√çTICO: Removido bloco .css() com largura/altura fixa.\n            // A classe .ph-mini-item no styles.css j√° define width: 34px; height: 34px;\n\n            // Atributos de dados\n            newItem.attr('data-name', itemData.name);\n            newItem.attr('data-xp', itemData.xp);\n            newItem.attr('data-image', itemData.image);\n            newItem.attr('data-isimage', itemData.isimage);\n            newItem.attr('data-date', itemData.date);\n\n            if (itemData.timestamp) {\n                newItem.attr('data-timestamp', itemData.timestamp);\n            }\n\n            newItem.attr('title', itemData.name);\n            newItem.attr('aria-label', itemData.name);\n\n            newItem.append('<div class=\"d-none ph-item-description-content\">' + (itemData.description || '') + '</div>');\n            newItem.append(contentHtml);\n\n            // Remove duplicatas\n            stash.children().filter(function() {\n                return $(this).attr('data-name') === itemData.name;\n            }).remove();\n\n            newItem.hide();\n            stash.prepend(newItem);\n            newItem.fadeIn();\n\n            // Limita a quantidade\n            var limit = stash.hasClass('ph-widget-stash') ? 14 : 6;\n            var items = stash.children('.ph-mini-item');\n            if (items.length > limit) {\n                items.last().remove();\n            }\n        });\n    };\n\n    /**\n     * Updates the main Widget and Sidebar HUDs.\n     *\n     * @param {Object} data General game data (XP, Level, Progress).\n     * @param {Object|null} itemData Data of the collected item (optional).\n     */\n    var updateHud = function(data, itemData) {\n        var containers = $('.playerhud-widget-container, .block_playerhud_sidebar');\n\n        containers.each(function() {\n            var container = $(this);\n\n            if (container.hasClass('playerhud-widget-container')) {\n                container.removeClass(function(index, className) {\n                    return (className.match(/(^|\\s)ph-lvl-tier-\\S+/g) || []).join(' ');\n                }).addClass(data.level_class);\n            }\n\n            var sidebarGrid = container.find('.ph-sidebar-grid');\n            if (sidebarGrid.length) {\n                sidebarGrid.removeClass(function(index, className) {\n                    return (className.match(/(^|\\s)ph-lvl-tier-\\S+/g) || []).join(' ');\n                }).addClass(data.level_class);\n            }\n\n            var progressBar = container.find('.progress-bar');\n            progressBar.css('width', data.progress + '%').attr('aria-valuenow', data.progress);\n            progressBar.removeClass(function(index, className) {\n                return (className.match(/(^|\\s)ph-lvl-tier-\\S+/g) || []).join(' ');\n            }).addClass(data.level_class);\n\n            var levelBadge = container.find('.badge').filter(function() {\n                return $(this).text().match(/(Level|N√≠vel)/) || $(this).attr('class').match(/ph-lvl-tier-/);\n            });\n\n            if (levelBadge.length) {\n                levelBadge.removeClass(function(index, className) {\n                    return (className.match(/(^|\\s)ph-lvl-tier-\\S+/g) || []).join(' ');\n                }).addClass(data.level_class);\n\n                var label = (levelBadge.text().indexOf('N√≠vel') > -1) ? 'N√≠vel' : 'Level';\n                var lvlString = data.level;\n                if (typeof data.max_levels !== 'undefined' && data.max_levels > 0) {\n                    lvlString += '/' + data.max_levels;\n                }\n                levelBadge.text(label + ' ' + lvlString);\n            }\n\n            container.find('span, div, strong').each(function() {\n                var el = $(this);\n                if (el.children().length === 0 && el.text().indexOf('XP') > -1) {\n                    var xpString = data.currentxp;\n                    if (typeof data.xp_target !== 'undefined' && data.xp_target > 0) {\n                        xpString += ' / ' + data.xp_target;\n                    }\n                    xpString += ' XP';\n                    if (data.is_win) {\n                        xpString += ' üèÜ';\n                    }\n                    el.text(xpString);\n                }\n            });\n        });\n\n        if (itemData) {\n            updateStash(itemData);\n        }\n    };\n\n    return {\n        /**\n         * Initialize the collect script.\n         *\n         * @param {Object} strings Language strings.\n         */\n        init: function(strings) {\n            var $filterModal = $('#phItemModalFilter');\n            if ($filterModal.length) {\n                $filterModal.appendTo('body');\n            }\n\n            // --- NOVO: Confirma√ß√£o de Desativa√ß√£o (Widget) ---\n            $('body').on('click', '.js-disable-hud', function(e) {\n                e.preventDefault();\n                var url = $(this).attr('href');\n                var msg = $(this).attr('data-confirm-msg');\n\n                Notification.confirm(\n                    strings.confirm_title,\n                    msg,\n                    strings.yes,\n                    strings.cancel,\n                    function() {\n                        window.location.href = url;\n                    }\n                );\n            });\n\n            // --- CLICK: ABRIR DETALHES DO ITEM ---\n            // eslint-disable-next-line complexity\n            $('body').on('click keydown', '.ph-item-details-trigger', function(e) {\n                if (e.type === 'keydown' && e.key !== 'Enter' && e.key !== ' ') {\n                    return;\n                }\n                e.preventDefault();\n\n                var trigger = $(this);\n                var container = trigger.closest('.playerhud-item-card, .ph-drop-image-container, .ph-mini-item');\n                if (container.length === 0) {\n                    container = trigger;\n                }\n\n                // Extra√ß√£o de Dados\n                var name = container.attr('data-name');\n                var descB64 = container.attr('data-desc-b64');\n                var descDirect = container.find('.ph-item-description-content').html();\n                var img = container.attr('data-image');\n                var isImg = container.attr('data-isimage');\n                var xp = container.attr('data-xp');\n                var date = container.attr('data-date'); // Fallback (Texto PHP)\n                var timestamp = container.attr('data-timestamp'); // Timestamp num√©rico\n\n                // *** OBTEN√á√ÉO INTELIGENTE DO MODAL ***\n                var modalEls = getModalElements();\n\n                // Se nenhum modal existir (erro grave), sai.\n                if (!modalEls.root.length) {\n                    return;\n                }\n\n                // Preenche Campos.\n                modalEls.title.text(name);\n                modalEls.name.text(name);\n\n                // Badge XP.\n                if (xp && xp !== '0' && xp.indexOf('???') === -1) {\n                    var xpText = ($.isNumeric(xp)) ? xp + ' XP' : xp;\n                    modalEls.xp.text(xpText).removeClass('d-none').show();\n                } else {\n                    modalEls.xp.hide();\n                }\n\n                // Esconde contador no modal (padr√£o).\n                if (modalEls.countBadge && modalEls.countBadge.length) {\n                    modalEls.countBadge.hide();\n                }\n\n                // Descri√ß√£o.\n                var descHtml = '...';\n                if (descDirect) {\n                    descHtml = descDirect;\n                } else if (descB64) {\n                    try {\n                        descHtml = decodeURIComponent(escape(window.atob(descB64)));\n                    } catch (err) {\n                        descHtml = '...';\n                    }\n                }\n                modalEls.desc.html(descHtml);\n\n                // --- Internacionaliza√ß√£o da Data ---\n                var dateEl = (modalEls.root.attr('id') === 'phItemModalView') ? modalEls.date : $('#phModalDateF');\n                var dateContainer = (modalEls.root.attr('id') === 'phItemModalView') ?\n                    modalEls.date :\n                    modalEls.dateContainer;\n\n                var formattedDate = '';\n\n                if (timestamp && timestamp > 0) {\n                    var lang = $('html').attr('lang') || 'en';\n                    lang = lang.replace('_', '-');\n                    try {\n                        // Formato: 2 d√≠gitos (07/02/26)\n                        formattedDate = new Date(parseInt(timestamp) * 1000).toLocaleDateString(lang, {\n                            day: '2-digit',\n                            month: '2-digit',\n                            year: '2-digit'\n                        });\n                    } catch (err) {\n                        formattedDate = date;\n                    }\n                } else {\n                    formattedDate = date; // Fallback\n                }\n\n                // Aplica a data formatada\n                if (formattedDate) {\n                    var prefix = (strings.last_collected ? strings.last_collected + ' ' : '');\n\n                    if (modalEls.root.attr('id') !== 'phItemModalView') {\n                        // Modal do Filtro (texto direto)\n                        dateEl.text(prefix + formattedDate);\n                        if (dateContainer) {\n                            dateContainer.removeClass('d-none');\n                        }\n                    } else {\n                        // Modal do Bloco (span interno)\n                        dateEl.find('span').text(prefix + formattedDate);\n                        dateEl.show();\n                    }\n                } else {\n                    if (modalEls.root.attr('id') !== 'phItemModalView') {\n                        if (dateContainer) {\n                            dateContainer.addClass('d-none');\n                        }\n                    } else {\n                        dateEl.hide();\n                    }\n                }\n                // -----------------------------------\n\n                // Imagem.\n                modalEls.imgContainer.empty();\n                if (isImg == '1') {\n                    modalEls.imgContainer.append($('<img>', {\n                        src: img,\n                        'class': 'ph-modal-img',\n                        alt: ''\n                    }));\n                } else {\n                    modalEls.imgContainer.append($('<span>', {\n                        'class': 'ph-modal-emoji',\n                        'aria-hidden': 'true',\n                        text: img\n                    }));\n                }\n\n                // Show Modal (Bootstrap 5 Check).\n                var modalEl = modalEls.root[0];\n                if (typeof bootstrap !== 'undefined' && bootstrap.Modal) {\n                    bootstrap.Modal.getOrCreateInstance(modalEl).show();\n                } else {\n                    modalEls.root.modal('show');\n                }\n            });\n\n            // --- CLICK: COLETAR ITEM (AJAX) ---\n            $('body').on('click', '.ph-action-collect', function(e) {\n                e.preventDefault();\n                var trigger = $(this);\n                var mode = trigger.attr('data-mode') || 'card';\n\n                if (trigger.hasClass('disabled') || trigger.attr('disabled')) {\n                    return;\n                }\n\n                var originalHtml = trigger.html();\n                var originalWidth = trigger.css('width');\n\n                if (mode === 'card') {\n                    trigger.css('width', trigger.outerWidth() + 'px');\n                    trigger.html('<i class=\"fa fa-spinner fa-spin\"></i>').addClass('disabled');\n                } else {\n                    trigger.css('opacity', '0.5').css('pointer-events', 'none');\n                }\n\n                var url = trigger.attr('href');\n                var ajaxUrl = url + (url.indexOf('?') === -1 ? '?' : '&') + 'ajax=1';\n\n                $.ajax({\n                    url: ajaxUrl,\n                    method: 'GET',\n                    dataType: 'json',\n                    success: function(resp) {\n                        if (resp.success) {\n                            // Pega os dados do servidor\n                            var serverDate = (resp.item_data && resp.item_data.date) ? resp.item_data.date : '';\n                            // Pega o timestamp\n                            var serverTs = (resp.item_data && resp.item_data.timestamp) ? resp.item_data.timestamp : 0;\n\n                            var card = trigger.closest('.playerhud-item-card');\n\n                            if (card.length) {\n                                var badge = card.find('.ph-badge-count');\n                                var isUnique = card.attr('data-unique') === '1';\n\n                                if (!isUnique) {\n                                    var currentCount = parseInt(badge.text().replace('x', ''), 10) || 0;\n                                    badge.text('x' + (currentCount + 1)).removeClass('d-none').show();\n                                }\n\n                                // Atualiza os dados no card\n                                card.attr('data-date', serverDate);\n                                card.attr('data-timestamp', serverTs);\n                            }\n\n                            if (mode === 'image') {\n                                var imgContainer = trigger.closest('.ph-drop-image-container');\n                                imgContainer.attr('data-date', serverDate);\n                                imgContainer.attr('data-timestamp', serverTs);\n                            }\n\n                            var hasTimer = (resp.cooldown_deadline && resp.cooldown_deadline > 0);\n                            var isLimit = resp.limit_reached;\n\n                            if (mode === 'text' || mode === 'image') {\n                                handleTextImageMode(trigger, mode, hasTimer, isLimit, resp);\n                            } else {\n                                handleCardMode(trigger, card, hasTimer, isLimit, resp, strings, originalHtml);\n                            }\n\n                            if (resp.game_data) {\n                                updateHud(resp.game_data, resp.item_data);\n                            }\n\n                        } else {\n                            restaurar(trigger, originalHtml, mode, originalWidth);\n                            Notification.alert('Ops', resp.message, 'OK');\n                        }\n                    },\n                    error: function() {\n                        restaurar(trigger, originalHtml, mode, originalWidth);\n                        Notification.alert('Erro', strings.error, 'OK');\n                    }\n                });\n            });\n        }\n    };\n});\n"],"names":["define","$","Notification","restaurar","btn","html","mode","width","removeClass","css","updateHud","data","itemData","each","container","this","hasClass","index","className","match","join","addClass","level_class","sidebarGrid","find","length","progressBar","progress","attr","levelBadge","filter","text","label","indexOf","lvlString","level","max_levels","el","children","xpString","currentxp","xp_target","is_win","stash","wrapper","closest","show","remove","contentHtml","String","isimage","image","newItem","name","xp","date","timestamp","append","description","hide","prepend","fadeIn","limit","items","last","updateStash","init","strings","$filterModal","appendTo","on","e","preventDefault","url","msg","confirm","confirm_title","yes","cancel","window","location","href","type","key","trigger","root","suffix","descB64","descDirect","img","isImg","modalEls","title","desc","imgContainer","countBadge","dateContainer","xpText","isNumeric","descHtml","decodeURIComponent","escape","atob","err","dateEl","formattedDate","lang","replace","Date","parseInt","toLocaleDateString","day","month","year","prefix","last_collected","empty","src","alt","modalEl","bootstrap","Modal","getOrCreateInstance","modal","originalHtml","originalWidth","outerWidth","ajaxUrl","ajax","method","dataType","success","resp","serverDate","item_data","serverTs","card","badge","currentCount","hasTimer","cooldown_deadline","isLimit","limit_reached","removeAttr","imgWrapper","first","oldColor","setTimeout","handleTextImageMode","tHtml","tBtn","replaceWith","focus","collected","handleCardMode","game_data","alert","message","error"],"mappings":"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"}