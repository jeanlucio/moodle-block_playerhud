{"version":3,"file":"filter_collect.min.js","sources":["../src/filter_collect.js"],"sourcesContent":["/* global bootstrap */\ndefine(['jquery', 'core/notification'], function($, Notification) {\n\n    /**\n     * Helper to retrieve modal elements, prioritizing the Block's modal if present.\n     * This ensures strict visual standardization and centralized maintenance.\n     *\n     * @return {Object} An object containing jQuery references to modal elements.\n     */\n    var getModalElements = function() {\n        // 1. Tenta encontrar o Modal \"Original\" do Bloco (Prioridade).\n        // IDs definidos em: blocks/playerhud/templates/modal_item.mustache.\n        var root = $('#phItemModalView');\n        var suffix = 'View';\n\n        // 2. Se n√£o existir (ex: p√°gina sem blocos), usa o Modal do Filtro (Fallback).\n        // IDs definidos em: filter/playerhud/templates/modals.mustache.\n        if (!root.length) {\n            root = $('#phItemModalFilter');\n            suffix = 'F';\n        }\n\n        return {\n            root: root,\n            // Seletores din√¢micos: adiciona o sufixo 'View' ou 'F' conforme o modal encontrado.\n            title: $('#phModalTitle' + suffix),\n            name: $('#phModalName' + suffix),\n            desc: $('#phModalDesc' + suffix),\n            imgContainer: $('#phModalImageContainer' + suffix),\n            xp: $('#phModalXP' + suffix),\n            countBadge: $('#phModalCountBadge' + suffix),\n            date: $('#phModalDate' + suffix),\n            dateContainer: $('#phModalDateContainer' + suffix)\n        };\n    };\n\n    /**\n     * Restores the button state in case of error or completion.\n     *\n     * @param {Object} btn The jQuery button element.\n     * @param {String} html The original HTML content of the button.\n     * @param {String} mode The display mode ('card', 'text', 'image').\n     * @param {String} width The original width of the button (for card mode).\n     */\n    var restaurar = function(btn, html, mode, width) {\n        btn.html(html).removeClass('disabled');\n        if (mode === 'card') {\n            btn.css('width', width);\n        } else {\n            btn.css('opacity', '1').css('pointer-events', 'auto');\n        }\n    };\n\n    /**\n     * Handles the visual state for Card Mode.\n     *\n     * @param {Object} trigger The clicked jQuery element.\n     * @param {Object} card The parent card jQuery element.\n     * @param {Boolean} hasTimer Whether the item is in cooldown.\n     * @param {Boolean} isLimit Whether the collection limit is reached.\n     * @param {Object} resp The server response object.\n     * @param {Object} strings The language strings object.\n     * @param {String} originalHtml The original HTML of the trigger.\n     */\n    var handleCardMode = function(trigger, card, hasTimer, isLimit, resp, strings, originalHtml) {\n        if (hasTimer) {\n            trigger.removeClass('btn-primary ph-action-collect').removeAttr('href');\n            var tHtml = '‚è≥ <span class=\"ph-timer\" data-deadline=\"' +\n                resp.cooldown_deadline + '\">...</span>';\n            var tBtn = $('<div class=\"btn btn-light btn-sm w-100 ph-text-dimmed\" tabindex=\"0\">' +\n                tHtml + '</div>');\n            trigger.replaceWith(tBtn);\n            tBtn.focus();\n        } else if (isLimit) {\n            trigger.removeClass('btn-primary ph-action-collect')\n                .addClass('btn-light text-success disabled border-success')\n                .css('cursor', 'default').removeAttr('href')\n                .html('<i class=\"fa fa-check\" aria-hidden=\"true\"></i> ' + strings.collected);\n            card.find('.ph-item-details-trigger').focus();\n        } else {\n            trigger.removeClass('btn-primary disabled').addClass('btn-success')\n                .html('<i class=\"fa fa-check\" aria-hidden=\"true\"></i> ' + strings.collected).css('width', '');\n            setTimeout(function() {\n                trigger.removeClass('btn-success').addClass('btn-primary')\n                    .html(originalHtml);\n                trigger.focus();\n            }, 1500);\n        }\n    };\n\n    /**\n     * Handles the visual state for Text and Image modes.\n     *\n     * @param {Object} trigger The clicked jQuery element.\n     * @param {String} mode The display mode ('text' or 'image').\n     * @param {Boolean} hasTimer Whether the item is in cooldown.\n     * @param {Boolean} isLimit Whether the collection limit is reached.\n     * @param {Object} resp The server response object.\n     */\n    var handleTextImageMode = function(trigger, mode, hasTimer, isLimit, resp) {\n        if (hasTimer || isLimit) {\n            if (mode === 'text') {\n                trigger.removeAttr('href').removeClass('ph-action-collect');\n                trigger.addClass('ph-item-details-trigger');\n                trigger.css('opacity', '1').css('pointer-events', 'auto').css('cursor', 'pointer');\n\n                if (isLimit) {\n                    trigger.addClass('text-success fw-bold')\n                        .html('<i class=\"fa fa-check\" aria-hidden=\"true\"></i> ' + trigger.text());\n                } else {\n                    trigger.addClass('ph-text-dimmed')\n                        .html('<span aria-hidden=\"true\">‚è≥</span> ' + trigger.text() +\n                        ' <small class=\"ph-timer\" data-deadline=\"' +\n                        resp.cooldown_deadline + '\">...</small>');\n                }\n            } else {\n                var container = trigger.closest('.ph-drop-image-container');\n                var imgWrapper = container.find('> div').first();\n                trigger.remove();\n\n                // Transforma container em gatilho.\n                container.addClass('ph-item-details-trigger')\n                         .attr('tabindex', '0')\n                         .attr('role', 'button')\n                         .css('cursor', 'pointer');\n\n                if (isLimit) {\n                    imgWrapper.addClass('ph-state-grayscale');\n                    container.append('<span class=\"badge bg-success rounded-circle ph-badge-bottom-right\">' +\n                        '<i class=\"fa fa-check\" aria-hidden=\"true\"></i></span>');\n                } else {\n                    imgWrapper.addClass('ph-state-dimmed');\n                    container.append('<div class=\"ph-timer badge bg-light text-dark border shadow-sm ph-badge-bottom-center\" ' +\n                        'data-deadline=\"' + resp.cooldown_deadline + '\" data-no-label=\"1\">...</div>');\n                }\n            }\n        } else {\n            if (mode === 'text') {\n                trigger.css('opacity', '1').css('pointer-events', 'auto');\n                var oldColor = trigger.css('color');\n                trigger.css('color', '#198754');\n                setTimeout(function() {\n                    trigger.css('color', oldColor);\n                }, 1000);\n            } else {\n                trigger.css('opacity', '1').css('pointer-events', 'auto');\n            }\n        }\n    };\n\n    /**\n     * Updates the Stash (Recent Items) UI.\n     * Separated to reduce complexity.\n     *\n     * @param {Object} itemData Data of the collected item.\n     */\n    var updateStash = function(itemData) {\n        var stashes = $('.ph-sidebar-stash, .ph-widget-stash');\n\n        stashes.each(function() {\n            var stash = $(this);\n            var wrapper = stash.closest('.ph-stash-wrapper');\n\n            // [CORRE√á√ÉO CR√çTICA]\n            // Se o wrapper existir (no caso do Bloco), removemos 'd-none'.\n            // Isso garante que se for o primeiro item, a √°rea fique vis√≠vel imediatamente.\n            if (wrapper.length) {\n                wrapper.removeClass('d-none').show();\n            }\n\n            // Remove mensagens de \"Vazio\" (se houver, especialmente no Widget)\n            stash.find('.text-muted').remove();\n            stash.find('span.small').remove(); // Garante limpeza gen√©rica\n\n            var contentHtml = '';\n            if (String(itemData.isimage) === '1') {\n                contentHtml = '<img src=\"' + itemData.image + '\" alt=\"\" ' +\n                    'style=\"width: 100%; height: 100%; object-fit: contain;\">';\n            } else {\n                contentHtml = '<span class=\"ph-mini-emoji\" aria-hidden=\"true\" ' +\n                    'style=\"font-size:1.2rem; line-height: 1;\">' + itemData.image + '</span>';\n            }\n\n            var classes = 'ph-mini-item ph-item-trigger border bg-white rounded ' +\n                'd-flex align-items-center justify-content-center overflow-hidden position-relative shadow-sm';\n\n            var newItem = $('<div class=\"' + classes + '\" role=\"button\" tabindex=\"0\"></div>');\n\n            newItem.css({\n                'width': '34px',\n                'height': '34px',\n                'min-width': '34px',\n                'margin-right': '2px',\n                'margin-bottom': '2px'\n            });\n\n            // Atributos de dados\n            newItem.attr('data-name', itemData.name);\n            newItem.attr('data-xp', itemData.xp);\n            newItem.attr('data-image', itemData.image);\n            newItem.attr('data-isimage', itemData.isimage);\n            newItem.attr('data-date', itemData.date); // Texto fallback\n\n            // Adiciona o timestamp para formata√ß√£o correta\n            if (itemData.timestamp) {\n                newItem.attr('data-timestamp', itemData.timestamp);\n            }\n\n            newItem.attr('title', itemData.name);\n            newItem.attr('aria-label', itemData.name);\n\n            newItem.append('<div class=\"d-none ph-item-description-content\">' + (itemData.description || '') + '</div>');\n            newItem.append(contentHtml);\n\n            // Remove duplicatas se o item j√° estiver na lista (atualiza a posi√ß√£o)\n            stash.children().filter(function() {\n                return $(this).attr('data-name') === itemData.name;\n            }).remove();\n\n            newItem.hide();\n            stash.prepend(newItem);\n            newItem.fadeIn();\n\n            // Limita a quantidade de itens vis√≠veis\n            var limit = stash.hasClass('ph-widget-stash') ? 14 : 6;\n            var items = stash.children('.ph-mini-item');\n            if (items.length > limit) {\n                items.last().remove();\n            }\n        });\n    };\n\n    /**\n     * Updates the main Widget and Sidebar HUDs.\n     *\n     * @param {Object} data General game data (XP, Level, Progress).\n     * @param {Object|null} itemData Data of the collected item (optional).\n     */\n    var updateHud = function(data, itemData) {\n        var containers = $('.playerhud-widget-container, .block_playerhud_sidebar');\n\n        containers.each(function() {\n            var container = $(this);\n\n            if (container.hasClass('playerhud-widget-container')) {\n                container.removeClass(function(index, className) {\n                    return (className.match(/(^|\\s)ph-lvl-tier-\\S+/g) || []).join(' ');\n                }).addClass(data.level_class);\n            }\n\n            var sidebarGrid = container.find('.ph-sidebar-grid');\n            if (sidebarGrid.length) {\n                sidebarGrid.removeClass(function(index, className) {\n                    return (className.match(/(^|\\s)ph-lvl-tier-\\S+/g) || []).join(' ');\n                }).addClass(data.level_class);\n            }\n\n            var progressBar = container.find('.progress-bar');\n            progressBar.css('width', data.progress + '%').attr('aria-valuenow', data.progress);\n            progressBar.removeClass(function(index, className) {\n                return (className.match(/(^|\\s)ph-lvl-tier-\\S+/g) || []).join(' ');\n            }).addClass(data.level_class);\n\n            var levelBadge = container.find('.badge').filter(function() {\n                return $(this).text().match(/(Level|N√≠vel)/) || $(this).attr('class').match(/ph-lvl-tier-/);\n            });\n\n            if (levelBadge.length) {\n                levelBadge.removeClass(function(index, className) {\n                    return (className.match(/(^|\\s)ph-lvl-tier-\\S+/g) || []).join(' ');\n                }).addClass(data.level_class);\n\n                var label = (levelBadge.text().indexOf('N√≠vel') > -1) ? 'N√≠vel' : 'Level';\n                var lvlString = data.level;\n                if (typeof data.max_levels !== 'undefined' && data.max_levels > 0) {\n                    lvlString += '/' + data.max_levels;\n                }\n                levelBadge.text(label + ' ' + lvlString);\n            }\n\n            container.find('span, div, strong').each(function() {\n                var el = $(this);\n                if (el.children().length === 0 && el.text().indexOf('XP') > -1) {\n                    var xpString = data.currentxp;\n                    if (typeof data.xp_target !== 'undefined' && data.xp_target > 0) {\n                        xpString += ' / ' + data.xp_target;\n                    }\n                    xpString += ' XP';\n                    if (data.is_win) {\n                        xpString += ' üèÜ';\n                    }\n                    el.text(xpString);\n                }\n            });\n        });\n\n        if (itemData) {\n            updateStash(itemData);\n        }\n    };\n\n    return {\n        /**\n         * Initialize the collect script.\n         *\n         * @param {Object} strings Language strings.\n         */\n        init: function(strings) {\n            var $filterModal = $('#phItemModalFilter');\n            if ($filterModal.length) {\n                $filterModal.appendTo('body');\n            }\n\n            // --- CLICK: ABRIR DETALHES DO ITEM ---\n            // eslint-disable-next-line complexity\n            $('body').on('click keydown', '.ph-item-details-trigger', function(e) {\n                if (e.type === 'keydown' && e.key !== 'Enter' && e.key !== ' ') {\n                    return;\n                }\n                e.preventDefault();\n\n                var trigger = $(this);\n                var container = trigger.closest('.playerhud-item-card, .ph-drop-image-container, .ph-mini-item');\n                if (container.length === 0) {\n                    container = trigger;\n                }\n\n                // Extra√ß√£o de Dados\n                var name = container.attr('data-name');\n                var descB64 = container.attr('data-desc-b64');\n                var descDirect = container.find('.ph-item-description-content').html();\n                var img = container.attr('data-image');\n                var isImg = container.attr('data-isimage');\n                var xp = container.attr('data-xp');\n                var date = container.attr('data-date'); // Fallback (Texto PHP)\n                var timestamp = container.attr('data-timestamp'); // Timestamp num√©rico\n\n                // *** OBTEN√á√ÉO INTELIGENTE DO MODAL ***\n                var modalEls = getModalElements();\n\n                // Se nenhum modal existir (erro grave), sai.\n                if (!modalEls.root.length) {\n                    return;\n                }\n\n                // Preenche Campos.\n                modalEls.title.text(name);\n                modalEls.name.text(name);\n\n                // Badge XP.\n                if (xp && xp !== '0' && xp.indexOf('???') === -1) {\n                    var xpText = ($.isNumeric(xp)) ? xp + ' XP' : xp;\n                    modalEls.xp.text(xpText).removeClass('d-none').show();\n                } else {\n                    modalEls.xp.hide();\n                }\n\n                // Esconde contador no modal (padr√£o).\n                if (modalEls.countBadge && modalEls.countBadge.length) {\n                    modalEls.countBadge.hide();\n                }\n\n                // Descri√ß√£o.\n                var descHtml = '...';\n                if (descDirect) {\n                    descHtml = descDirect;\n                } else if (descB64) {\n                    try {\n                        descHtml = decodeURIComponent(escape(window.atob(descB64)));\n                    } catch (err) {\n                        descHtml = '...';\n                    }\n                }\n                modalEls.desc.html(descHtml);\n\n                // --- Internacionaliza√ß√£o da Data ---\n                var dateEl = (modalEls.root.attr('id') === 'phItemModalView') ? modalEls.date : $('#phModalDateF');\n                var dateContainer = (modalEls.root.attr('id') === 'phItemModalView') ?\n                    modalEls.date :\n                    modalEls.dateContainer;\n\n                var formattedDate = '';\n\n                if (timestamp && timestamp > 0) {\n                    var lang = $('html').attr('lang') || 'en';\n                    lang = lang.replace('_', '-');\n                    try {\n                        // Formato: 2 d√≠gitos (07/02/26)\n                        formattedDate = new Date(parseInt(timestamp) * 1000).toLocaleDateString(lang, {\n                            day: '2-digit',\n                            month: '2-digit',\n                            year: '2-digit'\n                        });\n                    } catch (err) {\n                        formattedDate = date;\n                    }\n                } else {\n                    formattedDate = date; // Fallback\n                }\n\n                // Aplica a data formatada\n                if (formattedDate) {\n                    var prefix = (strings.last_collected ? strings.last_collected + ' ' : '');\n\n                    if (modalEls.root.attr('id') !== 'phItemModalView') {\n                        // Modal do Filtro (texto direto)\n                        dateEl.text(prefix + formattedDate);\n                        if (dateContainer) {\n                            dateContainer.removeClass('d-none');\n                        }\n                    } else {\n                        // Modal do Bloco (span interno)\n                        dateEl.find('span').text(prefix + formattedDate);\n                        dateEl.show();\n                    }\n                } else {\n                    if (modalEls.root.attr('id') !== 'phItemModalView') {\n                        if (dateContainer) {\n                            dateContainer.addClass('d-none');\n                        }\n                    } else {\n                        dateEl.hide();\n                    }\n                }\n                // -----------------------------------\n\n                // Imagem.\n                modalEls.imgContainer.empty();\n                if (isImg == '1') {\n                    modalEls.imgContainer.append($('<img>', {\n                        src: img,\n                        'class': 'ph-modal-img',\n                        alt: ''\n                    }));\n                } else {\n                    modalEls.imgContainer.append($('<span>', {\n                        'class': 'ph-modal-emoji',\n                        'aria-hidden': 'true',\n                        text: img\n                    }));\n                }\n\n                // Show Modal (Bootstrap 5 Check).\n                var modalEl = modalEls.root[0];\n                if (typeof bootstrap !== 'undefined' && bootstrap.Modal) {\n                    bootstrap.Modal.getOrCreateInstance(modalEl).show();\n                } else {\n                    modalEls.root.modal('show');\n                }\n            });\n\n            // --- CLICK: COLETAR ITEM (AJAX) ---\n            $('body').on('click', '.ph-action-collect', function(e) {\n                e.preventDefault();\n                var trigger = $(this);\n                var mode = trigger.attr('data-mode') || 'card';\n\n                if (trigger.hasClass('disabled') || trigger.attr('disabled')) {\n                    return;\n                }\n\n                var originalHtml = trigger.html();\n                var originalWidth = trigger.css('width');\n\n                if (mode === 'card') {\n                    trigger.css('width', trigger.outerWidth() + 'px');\n                    trigger.html('<i class=\"fa fa-spinner fa-spin\"></i>').addClass('disabled');\n                } else {\n                    trigger.css('opacity', '0.5').css('pointer-events', 'none');\n                }\n\n                var url = trigger.attr('href');\n                var ajaxUrl = url + (url.indexOf('?') === -1 ? '?' : '&') + 'ajax=1';\n\n                $.ajax({\n                    url: ajaxUrl,\n                    method: 'GET',\n                    dataType: 'json',\n                    success: function(resp) {\n                        if (resp.success) {\n                            // Pega os dados do servidor\n                            var serverDate = (resp.item_data && resp.item_data.date) ? resp.item_data.date : '';\n                            // Pega o timestamp\n                            var serverTs = (resp.item_data && resp.item_data.timestamp) ? resp.item_data.timestamp : 0;\n\n                            var card = trigger.closest('.playerhud-item-card');\n\n                            if (card.length) {\n                                var badge = card.find('.ph-badge-count');\n                                var isUnique = card.attr('data-unique') === '1';\n\n                                if (!isUnique) {\n                                    var currentCount = parseInt(badge.text().replace('x', ''), 10) || 0;\n                                    badge.text('x' + (currentCount + 1)).removeClass('d-none').show();\n                                }\n\n                                // Atualiza os dados no card\n                                card.attr('data-date', serverDate);\n                                card.attr('data-timestamp', serverTs);\n                            }\n\n                            if (mode === 'image') {\n                                var imgContainer = trigger.closest('.ph-drop-image-container');\n                                imgContainer.attr('data-date', serverDate);\n                                imgContainer.attr('data-timestamp', serverTs);\n                            }\n\n                            var hasTimer = (resp.cooldown_deadline && resp.cooldown_deadline > 0);\n                            var isLimit = resp.limit_reached;\n\n                            if (mode === 'text' || mode === 'image') {\n                                handleTextImageMode(trigger, mode, hasTimer, isLimit, resp);\n                            } else {\n                                handleCardMode(trigger, card, hasTimer, isLimit, resp, strings, originalHtml);\n                            }\n\n                            if (resp.game_data) {\n                                updateHud(resp.game_data, resp.item_data);\n                            }\n\n                        } else {\n                            restaurar(trigger, originalHtml, mode, originalWidth);\n                            Notification.alert('Ops', resp.message, 'OK');\n                        }\n                    },\n                    error: function() {\n                        restaurar(trigger, originalHtml, mode, originalWidth);\n                        Notification.alert('Erro', strings.error, 'OK');\n                    }\n                });\n            });\n        }\n    };\n});\n"],"names":["define","$","Notification","restaurar","btn","html","mode","width","removeClass","css","updateHud","data","itemData","each","container","this","hasClass","index","className","match","join","addClass","level_class","sidebarGrid","find","length","progressBar","progress","attr","levelBadge","filter","text","label","indexOf","lvlString","level","max_levels","el","children","xpString","currentxp","xp_target","is_win","stash","wrapper","closest","show","remove","contentHtml","String","isimage","image","newItem","name","xp","date","timestamp","append","description","hide","prepend","fadeIn","limit","items","last","updateStash","init","strings","$filterModal","appendTo","on","e","type","key","preventDefault","trigger","root","suffix","descB64","descDirect","img","isImg","modalEls","title","desc","imgContainer","countBadge","dateContainer","xpText","isNumeric","descHtml","decodeURIComponent","escape","window","atob","err","dateEl","formattedDate","lang","replace","Date","parseInt","toLocaleDateString","day","month","year","prefix","last_collected","empty","src","alt","modalEl","bootstrap","Modal","getOrCreateInstance","modal","originalHtml","originalWidth","outerWidth","url","ajaxUrl","ajax","method","dataType","success","resp","serverDate","item_data","serverTs","card","badge","currentCount","hasTimer","cooldown_deadline","isLimit","limit_reached","removeAttr","imgWrapper","first","oldColor","setTimeout","handleTextImageMode","tHtml","tBtn","replaceWith","focus","collected","handleCardMode","game_data","alert","message","error"],"mappings":"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"}