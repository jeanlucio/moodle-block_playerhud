{"version":3,"file":"view.min.js","sources":["../src/view.js"],"sourcesContent":["/* global bootstrap */\n/**\n * Student View JS for PlayerHUD.\n *\n * @module     block_playerhud/view\n * @copyright  2026 Jean LÃºcio\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/notification'], function($, Notification) {\n\n    return {\n        /**\n         * Initialize the view script.\n         *\n         * @param {Object} config The configuration object passed from PHP.\n         */\n        init: function(config) {\n            $('#phItemModalView').appendTo('body');\n\n            // 1. Disable HUD Confirmation.\n            $('.js-disable-hud').on('click', function(e) {\n                e.preventDefault();\n                var url = $(this).attr('href');\n                var msg = $(this).attr('data-confirm-msg');\n\n                Notification.confirm(\n                    config.strings.confirm_title,\n                    msg,\n                    config.strings.yes,\n                    config.strings.cancel,\n                    function() {\n                        window.location.href = url;\n                    }\n                );\n            });\n\n            $(document).on('keydown', '.ph-item-trigger', function(e) {\n                if (e.key === 'Enter' || e.key === ' ') {\n                    e.preventDefault();\n                    $(this).click();\n                }\n\n            });\n            // 2. Item Details Modal Logic.\n            /**\n             * Helper to open/close bootstrap modal safely.\n             */\n            function openItemModal() {\n                var el = document.getElementById('phItemModalView');\n                if (typeof $ !== 'undefined' && $.fn.modal) {\n                    $(el).modal('show');\n                } else {\n                    // Fallback for strict Moodle 4.x BS5.\n                    try {\n                        var m = bootstrap.Modal.getOrCreateInstance(el);\n                        m.show();\n                    } catch (e) {\n                        // eslint-disable-next-line no-console\n                        console.error(e);\n                    }\n                }\n            }\n\n            // Event Delegation for clicking on items.\n            $(document).on('click', '.ph-item-trigger', function(e) {\n                e.preventDefault();\n                var trigger = $(this);\n\n                // Extract data.\n                var name = trigger.attr('data-name');\n                var xp = trigger.attr('data-xp');\n                var img = trigger.attr('data-image');\n                var isImg = trigger.attr('data-isimage'); // String \"1\" or \"0\".\n                var date = trigger.attr('data-date');\n                var count = trigger.attr('data-count');\n                var desc = trigger.find('.ph-item-description-content').html();\n\n                // Populate Modal.\n                $('#phModalTitleView, #phModalNameView').text(name);\n                $('#phModalXPView').text(xp);\n\n                var descEl = $('#phModalDescView');\n                if (desc && desc.trim() !== '') {\n                    descEl.html(desc);\n                } else {\n                    descEl.html('<i class=\"text-muted\">' + config.strings.no_desc + '</i>');\n                }\n\n                var badgeEl = $('#phModalCountBadgeView');\n                if (count && count > 0) {\n                    badgeEl.text('x' + count).show();\n                } else {\n                    badgeEl.hide();\n                }\n\n                // Image Handling.\n                var imgCont = $('#phModalImageContainerView');\n                imgCont.empty();\n\n                if (isImg == '1' || isImg === 'true') {\n                    imgCont.append($('<img>', {\n                        src: img,\n                        'class': 'ph-modal-img',\n                        alt: '',\n                        style: 'max-width:120px; max-height:120px; object-fit:contain;'\n                    }));\n                } else {\n                    // Emoji.\n                    imgCont.append($('<span>', {\n                        'class': 'ph-modal-emoji',\n                        'aria-hidden': 'true',\n                        style: 'font-size:80px; line-height:1;',\n                        text: img\n                    }));\n                }\n\n                // Date.\n                var dateEl = $('#phModalDateView');\n                if (date) {\n                    dateEl.find('span').text(date);\n                    dateEl.show();\n                } else {\n                    dateEl.hide();\n                }\n\n                openItemModal();\n            });\n        }\n    };\n});\n"],"names":["define","$","Notification","init","config","appendTo","on","e","preventDefault","url","this","attr","msg","confirm","strings","confirm_title","yes","cancel","window","location","href","document","key","click","trigger","name","xp","img","isImg","date","count","desc","find","html","text","descEl","trim","no_desc","badgeEl","show","hide","imgCont","empty","append","src","alt","style","dateEl","el","getElementById","fn","modal","bootstrap","Modal","getOrCreateInstance","console","error","openItemModal"],"mappings":";;;;;;;AAQAA,8BAAO,CAAC,SAAU,sBAAsB,SAASC,EAAGC,oBAEzC,CAMHC,KAAM,SAASC,QACXH,EAAE,oBAAoBI,SAAS,QAG/BJ,EAAE,mBAAmBK,GAAG,SAAS,SAASC,GACtCA,EAAEC,qBACEC,IAAMR,EAAES,MAAMC,KAAK,QACnBC,IAAMX,EAAES,MAAMC,KAAK,oBAEvBT,aAAaW,QACTT,OAAOU,QAAQC,cACfH,IACAR,OAAOU,QAAQE,IACfZ,OAAOU,QAAQG,QACf,WACIC,OAAOC,SAASC,KAAOX,UAKnCR,EAAEoB,UAAUf,GAAG,UAAW,oBAAoB,SAASC,GACrC,UAAVA,EAAEe,KAA6B,MAAVf,EAAEe,MACvBf,EAAEC,iBACFP,EAAES,MAAMa,YAyBhBtB,EAAEoB,UAAUf,GAAG,QAAS,oBAAoB,SAASC,GACjDA,EAAEC,qBACEgB,QAAUvB,EAAES,MAGZe,KAAOD,QAAQb,KAAK,aACpBe,GAAKF,QAAQb,KAAK,WAClBgB,IAAMH,QAAQb,KAAK,cACnBiB,MAAQJ,QAAQb,KAAK,gBACrBkB,KAAOL,QAAQb,KAAK,aACpBmB,MAAQN,QAAQb,KAAK,cACrBoB,KAAOP,QAAQQ,KAAK,gCAAgCC,OAGxDhC,EAAE,uCAAuCiC,KAAKT,MAC9CxB,EAAE,kBAAkBiC,KAAKR,QAErBS,OAASlC,EAAE,oBACX8B,MAAwB,KAAhBA,KAAKK,OACbD,OAAOF,KAAKF,MAEZI,OAAOF,KAAK,yBAA2B7B,OAAOU,QAAQuB,QAAU,YAGhEC,QAAUrC,EAAE,0BACZ6B,OAASA,MAAQ,EACjBQ,QAAQJ,KAAK,IAAMJ,OAAOS,OAE1BD,QAAQE,WAIRC,QAAUxC,EAAE,8BAChBwC,QAAQC,QAEK,KAATd,OAA0B,SAAVA,MAChBa,QAAQE,OAAO1C,EAAE,QAAS,CACtB2C,IAAKjB,UACI,eACTkB,IAAK,GACLC,MAAO,4DAIXL,QAAQE,OAAO1C,EAAE,SAAU,OACd,+BACM,OACf6C,MAAO,iCACPZ,KAAMP,WAKVoB,OAAS9C,EAAE,oBACX4B,MACAkB,OAAOf,KAAK,QAAQE,KAAKL,MACzBkB,OAAOR,QAEPQ,OAAOP,sBA1EPQ,GAAK3B,SAAS4B,eAAe,2BAChB,IAANhD,GAAqBA,EAAEiD,GAAGC,MACjClD,EAAE+C,IAAIG,MAAM,iBAIAC,UAAUC,MAAMC,oBAAoBN,IAC1CT,OACJ,MAAOhC,GAELgD,QAAQC,MAAMjD,IAmEtBkD"}