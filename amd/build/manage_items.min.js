define("block_playerhud/manage_items",["jquery","core/notification"],(function($,Notification){return{init:function(config){$("#phAiModal").appendTo("body"),$("#ai-drop").on("change",(function(){$(this).is(":checked")?$("#ai-drop-options").slideDown():$("#ai-drop-options").slideUp()})),$("body").on("click",".js-delete-btn",(function(e){e.preventDefault();var btn=$(this),targetUrl=btn.attr("href"),msg=btn.attr("data-confirm-msg");Notification.confirm(config.strings.confirm_title,msg,config.strings.yes,config.strings.cancel,(function(){window.location.href=targetUrl}))})),$("#ph-ai-form").on("submit",(function(e){e.preventDefault(),$("#ph-btn-conjure").click()})),$("#ph-btn-conjure").click((function(e){e.preventDefault();var btn=$(this);if(!btn.prop("disabled")){var theme=$("#ai-theme").val(),xp=$("#ai-xp").val(),createDrop=$("#ai-drop").is(":checked"),locName=$("#ai-location").val(),maxUsage=$("#ai-maxusage").val(),respawn=$("#ai-respawn").val();if(theme){var originalText=btn.text();btn.prop("disabled",!0).text(config.strings.ai_creating),btn.attr("aria-busy","true"),$.ajax({url:M.cfg.wwwroot+"/blocks/playerhud/ajax_ai.php",method:"POST",dataType:"json",data:{instanceid:config.instanceid,id:config.courseid,theme:theme,xp:xp||0,create_drop:createDrop?1:0,drop_location:locName,drop_max:maxUsage,drop_time:respawn,sesskey:M.cfg.sesskey},success:function(resp){if(btn.prop("disabled",!1).text(originalText).removeAttr("aria-busy"),resp.success){var modalBody=$("#phAiModal .modal-body"),modalFooter=$("#phAiModal .modal-footer");$("#phAiModalLabel").text(config.strings.success_title);var successHtml='<div id="ph-success-container" tabindex="-1" class="text-center py-3 animate__animated animate__fadeIn" style="outline: none;">';if(successHtml+='<div class="mb-3" style="font-size: 3rem; color: #28a745;" aria-hidden="true"><i class="fa fa-check-circle"></i></div>',successHtml+='<h2 class="fw-bold text-primary mb-3">'+resp.item_name+"</h2>",successHtml+='<p class="lead text-muted mb-4">'+config.strings.success+"</p>",resp.drop_code){var fullShortcode="[PLAYERHUD_DROP code="+resp.drop_code+"]";successHtml+='<div class="card bg-light border-0 p-3 mx-auto" style="max-width: 90%;">',successHtml+='<label class="small text-muted mb-2 fw-bold text-start w-100" for="ph-gen-code-input">'+config.strings.copy+":</label>",successHtml+='<div class="input-group">',successHtml+='<input type="text" class="form-control font-monospace text-center" value="'+fullShortcode+'" id="ph-gen-code-input" readonly>',successHtml+='<button class="btn btn-primary" type="button" id="ph-btn-copy-code"><i class="fa fa-copy"></i></button>',successHtml+="</div>",successHtml+="</div>"}successHtml+="</div>",modalBody.html(successHtml);var btnReload=$('<button class="btn btn-success w-100 py-2 fw-bold">'+config.strings.great+"</button>");btnReload.on("click",(function(){window.location.reload()})),modalFooter.empty().append(btnReload),resp.drop_code&&setTimeout((function(){$("#ph-btn-copy-code").on("click",(function(){var copyText=document.getElementById("ph-gen-code-input");copyText.select(),copyText.setSelectionRange(0,99999),document.execCommand("copy");var $btn=$(this);$btn.removeClass("btn-primary").addClass("btn-success").html('<i class="fa fa-check"></i>'),setTimeout((function(){$btn.removeClass("btn-success").addClass("btn-primary").html('<i class="fa fa-copy"></i>')}),2e3)})),$("#ph-success-container").focus()}),200)}else Notification.alert("Error",resp.message,"OK")},error:function(xhr,status,error){btn.prop("disabled",!1).text(originalText).removeAttr("aria-busy");var errorMsg=error;if(xhr.responseJSON&&xhr.responseJSON.message)errorMsg=xhr.responseJSON.message;else if(xhr.responseText)try{var r=JSON.parse(xhr.responseText);r.message&&(errorMsg=r.message)}catch(e){}Notification.alert("Ops!",errorMsg,"OK")}})}else Notification.alert("Error",config.strings.err_theme,"OK")}}))}}}));

//# sourceMappingURL=manage_items.min.js.map