define("block_playerhud/manage_items",["jquery","core/notification","core/ajax","core/copy_to_clipboard"],(function($,Notification,Ajax){
/**
   * Manage Items module for PlayerHUD.
   *
   * @module     block_playerhud/manage_items
   * @copyright  2026 Jean LÃºcio
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */
return{init:function(config){$("#ph-ai-modal").appendTo("body"),$("#ph-item-modal-view").appendTo("body"),$("body").on("click","#btn-open-ai-modal",(function(e){e.preventDefault();const modalEl=document.getElementById("ph-ai-modal");if(modalEl)if("undefined"!=typeof bootstrap&&bootstrap.Modal){bootstrap.Modal.getOrCreateInstance(modalEl).show()}else $(modalEl).modal&&$(modalEl).modal("show")})),$("#ph-select-all").on("change",(function(){const isChecked=$(this).is(":checked");$(".ph-bulk-check").prop("checked",isChecked).trigger("change")})),$("body").on("change",".ph-bulk-check, #ph-select-all",(function(){const count=$(".ph-bulk-check:checked").length,$btn=$("#ph-btn-bulk-delete");if(count>0){$btn.removeClass("disabled").removeAttr("disabled");const btnText=config.strings.delete_n_items.replace("%d",count);$btn.html('<i class="fa fa-trash" aria-hidden="true"></i> '+btnText)}else $btn.addClass("disabled").attr("disabled","disabled"),$btn.html('<i class="fa fa-trash" aria-hidden="true"></i> '+config.strings.delete_selected)})),$("#ph-btn-bulk-delete").on("click",(function(e){e.preventDefault(),0!==$(".ph-bulk-check:checked").length&&Notification.confirm(config.strings.confirm_title,config.strings.confirm_bulk,config.strings.yes,config.strings.cancel,(function(){$("#bulk-action-form").submit()}))})),$("body").on("click",".ph-preview-trigger",(function(e){e.preventDefault();const trigger=$(this),name=trigger.attr("data-name"),xp=trigger.attr("data-xp"),img=trigger.attr("data-image"),isImg=trigger.attr("data-isimage"),descTarget=trigger.attr("data-desc-target"),descHtml=descTarget?$("#"+descTarget).html():"";$("#phModalNameView, #phModalTitleView").text(name),$("#phModalXPView").text(xp);const $descEl=$("#phModalDescView");descHtml&&""!==descHtml.trim()?$descEl.html(descHtml):$descEl.html('<i class="text-muted">'+config.strings.no_desc+"</i>");const $imgCont=$("#phModalImageContainerView");$imgCont.empty(),"1"===isImg?$imgCont.append($("<img>",{src:img,class:"ph-modal-img",alt:""})):$imgCont.append($("<span>",{class:"ph-modal-emoji","aria-hidden":"true",text:img}));const modalEl=document.getElementById("ph-item-modal-view");"undefined"!=typeof bootstrap&&bootstrap.Modal?bootstrap.Modal.getOrCreateInstance(modalEl).show():$(modalEl).modal("show")})),$("#ai-drop").on("change",(function(){$(this).is(":checked")?$("#ai-drop-options").slideDown():$("#ai-drop-options").slideUp()})),$("body").on("click",".js-delete-btn",(function(e){e.preventDefault();const $btn=$(this),targetUrl=$btn.attr("href"),msg=$btn.attr("data-confirm-msg");Notification.confirm(config.strings.confirm_title,msg,config.strings.yes,config.strings.cancel,(function(){window.location.href=targetUrl}))})),$("#ph-ai-form").on("submit",(function(e){e.preventDefault(),$("#ph-btn-conjure").click()})),$("#ph-btn-conjure").on("click",(function(e){e.preventDefault();const $btn=$(this);if($btn.prop("disabled"))return;const theme=$("#ai-theme").val();if(!theme)return void Notification.alert("Error",config.strings.err_theme,"OK");const originalText=$btn.text();$btn.prop("disabled",!0).text(config.strings.ai_creating).attr("aria-busy","true");const request={methodname:"block_playerhud_generate_ai_content",args:{instanceid:config.instanceid,courseid:config.courseid,theme:theme,xp:parseInt($("#ai-xp").val())||0,amount:parseInt($("#ai-amount").val())||1,create_drop:$("#ai-drop").is(":checked"),drop_location:$("#ai-location").val()||"",drop_max:parseInt($("#ai-maxusage").val())||0,drop_time:parseInt($("#ai-respawn").val())||0}};Ajax.call([request])[0].done((function(resp){if($btn.prop("disabled",!1).text(originalText).removeAttr("aria-busy"),resp.success){$("#ph-ai-modal").one("hidden.bs.modal",(function(){window.location.reload()}));$("#phAiModalLabel").text(config.strings.success_title);let successHtml='<div id="ph-success-container" tabindex="-1" ';successHtml+='class="text-center py-3 ph-animate-fadein" style="outline: none;">',successHtml+='<div class="mb-3 text-success" style="font-size: 3rem;" aria-hidden="true">',successHtml+='<i class="fa fa-check-circle"></i></div>';const items=resp.created_items||[];0===items.length&&resp.item_name&&items.push(resp.item_name);const itemsList=items.join(", "),count=items.length;if(successHtml+='<h5 class="text-muted text-uppercase small fw-bold mb-2">'+config.strings.created_count.replace("{$a}",count)+"</h5>",successHtml+='<h2 class="fw-bold text-dark mb-4 display-6">'+itemsList+"</h2>",resp.warning_msg?(successHtml+='<div class="alert alert-warning small mb-3 text-start">',successHtml+='<i class="fa fa-exclamation-triangle me-2" aria-hidden="true"></i> ',successHtml+=resp.warning_msg+"</div>"):resp.info_msg&&(successHtml+='<div class="alert alert-success small mb-3 text-start border-success bg-success-subtle text-success-emphasis">',successHtml+='<i class="fa fa-info-circle me-2" aria-hidden="true"></i> ',successHtml+=resp.info_msg+"</div>"),resp.drop_code&&1===count){const fullCode="[PLAYERHUD_DROP code="+resp.drop_code+"]";successHtml+='<div class="card bg-light border-0 p-3 mx-auto mt-4" style="max-width: 90%;">',successHtml+='<label class="small text-muted mb-1 fw-bold text-start w-100" ',successHtml+='for="ph-gen-code-input">'+config.strings.copy+":</label>",successHtml+='<div class="input-group">',successHtml+='<input type="text" class="form-control font-monospace text-center ph-code-input" ',successHtml+='value="'+fullCode+'" id="ph-gen-code-input" readonly>',successHtml+='<button class="btn btn-primary" type="button" ',successHtml+='data-action="copytoclipboard" data-clipboard-target="#ph-gen-code-input">',successHtml+='<i class="fa fa-copy" aria-hidden="true"></i> ',successHtml+=config.strings.copy+"</button>",successHtml+="</div></div>"}successHtml+="</div>",$("#ph-ai-modal .modal-body").html(successHtml);const $btnReload=$('<button class="btn btn-success w-100 py-2 fw-bold">'+config.strings.great+"</button>");$btnReload.on("click",(function(){window.location.reload()})),$("#ph-ai-modal .modal-footer").empty().append($btnReload),setTimeout((function(){$("#ph-success-container").focus()}),200)}else Notification.alert("Error",resp.message,"OK")})).fail((function(ex){$btn.prop("disabled",!1).text(originalText).removeAttr("aria-busy"),Notification.exception(ex)}))}))}}}));

//# sourceMappingURL=manage_items.min.js.map