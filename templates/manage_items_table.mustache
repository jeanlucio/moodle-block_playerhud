{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
    @template block_playerhud/manage_items_table

    Displays the list of items for management.

    @package    block_playerhud
    @copyright  2026 Jean LÃºcio <jeanlucio@gmail.com>
    @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
}}
<div class="d-flex flex-wrap justify-content-between align-items-center mb-3 p-3 bg-light rounded border shadow-sm ph-manage-header">
    <div class="d-flex align-items-center">
        <i class="fa fa-info-circle text-primary me-2 fa-lg" aria-hidden="true"></i>
        <span class="fw-bold text-dark">{{summary_text}}</span>
    </div>

    <div class="d-flex gap-3">
        <button type="button" class="btn btn-info text-white shadow-sm" id="btn-open-ai-modal">
             <i class="fa fa-magic me-1" aria-hidden="true"></i> {{str_ai_create}}
        </button>
        <a href="{{url_add}}" class="btn btn-primary shadow-sm ms-2">
            <i class="fa fa-plus-circle me-1" aria-hidden="true"></i> {{str_add_item}}
        </a>
    </div>
</div>

<form action="{{base_url}}" method="post" id="bulk-action-form">
    <input type="hidden" name="action" value="bulk_delete">
    <input type="hidden" name="sesskey" value="{{sesskey}}">

    <div class="card shadow-sm border-0">
        <div class="card-body p-0">
             <div class="table-responsive">
                <table class="table table-hover table-striped mb-0 align-middle">
                    <thead class="bg-light border-bottom">
                        <tr class="text-nowrap">
                            <th scope="col" class="ph-col-select">
                                <span class="accesshide">{{str_select_all}}</span>
                                <input type="checkbox" id="ph-select-all" class="form-check-input" title="{{str_select_all}}">
                            </th>
                            <th scope="col" class="ph-col-sm text-center">N.</th>
                            <th scope="col" class="ph-col-md text-center">{{str_col_image}}</th>

                            <th scope="col">
                                <a href="{{headers.name.url}}" class="text-dark text-decoration-none fw-bold d-flex align-items-center">
                                    {{headers.name.label}} <i class="fa {{headers.name.icon_class}} ms-1" aria-hidden="true"></i>
                                </a>
                            </th>
                            <th scope="col" class="ph-col-lg">
                                 <a href="{{headers.xp.url}}" class="text-dark text-decoration-none fw-bold d-flex align-items-center">
                                    {{headers.xp.label}} <i class="fa {{headers.xp.icon_class}} ms-1" aria-hidden="true"></i>
                                 </a>
                            </th>
                            <th scope="col" class="ph-col-xl">
                                <a href="{{headers.enabled.url}}" class="text-dark text-decoration-none fw-bold d-flex align-items-center">
                                    {{headers.enabled.label}} <i class="fa {{headers.enabled.icon_class}} ms-1" aria-hidden="true"></i>
                                </a>
                            </th>

                            <th scope="col" class="ph-col-xxl">{{str_col_drops}}</th>
                            <th scope="col" class="text-end ph-col-actions">{{str_actions}}</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{#items}}
                        <tr class="{{^enabled}}opacity-50{{/enabled}}">
                            <td class="ph-col-select">
                                <label class="accesshide" for="chk-{{id}}">{{str_select}} {{name}}</label>
                                <input type="checkbox" name="bulk_ids[]" value="{{id}}" id="chk-{{id}}" class="form-check-input ph-bulk-check">
                            </td>
                            <td class="align-middle text-center text-muted small">{{counter}}</td>
                            <td class="align-middle text-center position-relative">
                                 <a href="#" class="ph-preview-trigger text-decoration-none d-block"
                                   {{{preview_attributes}}} data-desc-target="desc_hidden_{{id}}" aria-label="{{str_col_image}}">
                                    {{#is_image}}
                                        <img src="{{image_url}}" class="ph-img-xs" alt="">
                                    {{/is_image}}
                                    {{^is_image}}
                                        <span class="ph-font-size-24" aria-hidden="true">{{image_content}}</span>
                                    {{/is_image}}
                                 </a>
                            </td>
                            <td class="align-middle">
                                 <a href="#" class="ph-preview-trigger text-dark text-decoration-none fw-bold"
                                   {{{preview_attributes}}} data-desc-target="desc_hidden_{{id}}">
                                    {{name}}
                                    {{#secret}}
                                        <i class="fa fa-user-secret text-warning ms-1" title="{{str_secret}}" aria-hidden="true"></i>
                                        <span class="visually-hidden">({{str_secret}})</span>
                                    {{/secret}}
                                </a>
                                <div id="desc_hidden_{{id}}" class="d-none">{{{description_html}}}</div>
                            </td>
                            <td class="align-middle">
                                 <span class="badge bg-primary text-white">+{{xp}} XP</span>
                            </td>
                            <td class="align-middle">
                                {{#enabled}}
                                    <span class="badge bg-success text-white">{{str_yes}}</span>
                                    <a href="{{url_toggle}}" class="btn btn-sm btn-light border ms-1" aria-label="{{str_hide}}">
                                        <i class="fa fa-eye text-success" aria-hidden="true"></i>
                                    </a>
                                {{/enabled}}
                                {{^enabled}}
                                    <span class="badge bg-secondary text-white">{{str_no}}</span>
                                    <a href="{{url_toggle}}" class="btn btn-sm btn-warning ms-1" aria-label="{{str_show}}">
                                        <i class="fa fa-eye-slash" aria-hidden="true"></i>
                                    </a>
                                {{/enabled}}
                            </td>
                            <td class="align-middle">
                                <a href="{{url_drops}}" class="btn btn-sm {{btn_drops_class}} w-100" aria-label="{{str_manage_drops}}">
                                    <i class="fa fa-map-marker me-1" aria-hidden="true"></i> Drops: <strong>{{drops_count}}</strong>
                                </a>
                            </td>
                            <td class="align-middle text-end">
                                <a href="{{url_edit}}" class="btn btn-sm btn-primary me-1 shadow-sm" aria-label="{{str_edit}}">
                                   <i class="fa fa-pencil me-1" aria-hidden="true"></i> {{str_edit}}
                                </a>
                                <a href="{{url_delete}}" class="btn btn-sm btn-danger shadow-sm js-delete-btn"
                                    aria-label="{{str_delete}}" data-confirm-msg="{{confirm_msg}}">
                                    <i class="fa fa-trash me-1" aria-hidden="true"></i> {{str_delete}}
                                </a>
                            </td>
                        </tr>
                        {{/items}}
                        {{^items}}
                        <tr>
                            <td colspan="8" class="text-center py-5 text-muted">{{str_empty}}</td>
                        </tr>
                        {{/items}}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="mt-3">
        <button type="submit" class="btn btn-danger shadow-sm disabled" id="ph-btn-bulk-delete" disabled>
            <i class="fa fa-trash me-1" aria-hidden="true"></i> {{str_delete_selected}}
        </button>
    </div>
</form>

{{{paging_bar}}}
{{{modal_ai_html}}}
{{{modal_preview_html}}}
