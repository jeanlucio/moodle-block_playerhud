{{!
    @template block_playerhud/sidebar_view
    Simplified view for the block sidebar with avatar and progress.
}}
<div class="block_playerhud_sidebar text-center">
    
    {{! Profile Section }}
    <div class="mb-3">
        <div class="mb-2 ph-sidebar-avatar">
            {{{userpicture}}}
        </div>
        <div class="fw-bold ph-text-truncate-100" title="{{username}}">
            {{username}}
        </div>
    </div>

    {{! Stats Bar }}
    <div class="d-flex justify-content-between align-items-center mb-1 small text-muted">
        <span class="badge {{level_class}} border">{{#str}} level, block_playerhud {{/str}} {{level}}</span>
        <span>{{xp}}</span>
    </div>

    <div class="ph-progress-container mb-3">
        <div class="progress-bar ph-progress-bar {{level_class}}" role="progressbar" 
             style="width: {{progress}}%;"
             aria-valuenow="{{progress}}" aria-valuemin="0" aria-valuemax="100">
            <span class="visually-hidden">{{progress}}% {{#str}} completed, core {{/str}}</span>
        </div>
    </div>

    {{! --- NOVO: BotÃ£o de Ranking --- }}
    {{#ranking}}
    <div class="mb-3">
        <a href="{{url}}" class="btn btn-light btn-sm w-100 border shadow-sm fw-bold text-dark d-flex align-items-center justify-content-center">
            <span class="me-2" style="font-size: 1.2rem;">ğŸ†</span> 
            <span>#{{rank}} - {{label}}</span>
        </a>
    </div>
    {{/ranking}}

    {{! Mini Stash Section }}
    <div class="mb-3 text-start ph-stash-wrapper {{^has_items}}d-none{{/has_items}}">
        <small class="text-muted text-uppercase fw-bold" style="font-size: 0.7rem;">
            {{#str}} latest_items, block_playerhud {{/str}}
        </small>
        <div class="ph-sidebar-stash mt-1">
            {{#items}}
            <div class="ph-mini-item ph-item-trigger" 
                 role="button" 
                 tabindex="0"
                 data-name="{{name}}"
                 data-xp="{{xp}}"
                 data-image="{{image}}"
                 data-isimage="{{isimage}}"
                 data-date="{{date}}"
                 title="{{name}}">
                 
                 <div class="d-none ph-item-description-content">{{{description}}}</div>

                 {{#isimage}}
                    <img src="{{image}}" alt="{{name}}">
                 {{/isimage}}
                 {{^isimage}}
                    <span class="ph-emoji" aria-hidden="true">{{image}}</span>
                 {{/isimage}}
            </div>
            {{/items}}
        </div>
    </div>

    {{! Actions }}
    <div class="d-grid gap-2">
        {{#isteacher}}
        <a href="{{{manageurl}}}" class="btn btn-outline-dark btn-sm shadow-sm mb-1">
            <i class="fa fa-cogs" aria-hidden="true"></i> {{#str}} master_panel, block_playerhud {{/str}}
        </a>
        {{/isteacher}}

        <a href="{{{viewurl}}}" class="btn btn-primary btn-sm shadow-sm">
            <i class="fa fa-briefcase" aria-hidden="true"></i> {{#str}} openbackpack, block_playerhud {{/str}}
        </a>
    </div>
</div>
